<div class="pdf-rutina-container">
    <div class="pdf-page">
        <!-- Encabezado profesional -->
        <div class="pdf-header">
            <div>
                <h1>{{ rutinaCruda?.rutina?.nombre || 'Rutina de Entrenamiento' }}</h1>
                <div class="pdf-header-info">
                    <span><strong>Nivel:</strong> {{ rutinaCruda?.rutina?.nivel_atleta }}</span>
                    <span><strong>Objetivo:</strong> {{ rutinaCruda?.rutina?.objetivo }}</span>
                    <span><strong>Días:</strong> {{ rutinaCruda?.rutina?.cantidad_dias }}</span>
                </div>
            </div>
        </div>

        <!-- Descripción de la rutina -->
        <div *ngIf="rutinaCruda?.rutina?.descripcion" class="rutina-descripcion">
            <h3>Descripción</h3>
            <p>{{ rutinaCruda?.rutina?.descripcion }}</p>
        </div>

        <!-- Detalle de días y ejercicios -->
        <div class="plan-entrenamiento">
            <h3>Plan de Entrenamiento</h3>

            <div *ngIf="!datosResueltos" class="loading-data">
                Cargando datos detallados...
            </div>

            <div *ngFor="let diaData of rutinaCruda?.ejercicios; let i = index" class="dia-container"
                [class.allow-break]="(diaData?.ejercicios?.length || 0) > 8"
                [class.page-break-before]="shouldBreakBefore(i)">
                <div class="dia-header">
                    DÍA {{ diaData?.dia || (i + 1) }}
                </div>

                <table class="ejercicios-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ejercicio</th>
                            <th>Grupo Muscular</th>
                            <th>Repeticiones / Series</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let ejercicio of diaData?.ejercicios; let j = index">
                            <td>{{ j + 1 }}</td>
                            <td>
                                {{ getNombreEjercicio(ejercicio) }}
                                <div class="small-fallback" *ngIf="!getNombreEjercicio(ejercicio)">
                                    ID: {{ ejercicio?.id_ejercicio }}
                                </div>
                            </td>
                            <td>
                                {{ getNombreGrupoMuscular(ejercicio) }}
                            </td>
                            <td>
                                {{ getDescripcionRepeticion(ejercicio) || ('ID: ' + (ejercicio?.id_repeticion || 'N/A'))
                                }}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pie de página profesional -->
        <div class="pdf-footer">
            <hr>
            <p><strong>Rutina generada por <a href="https://gymrats.com.ar" target="_blank">GymRats</a></strong> &copy;
                {{ currentDate | date:'yyyy' }}</p>
            <p>Fecha de generación: {{ currentDate | date:'dd/MM/yyyy HH:mm' }}</p>
        </div>
    </div>
</div>