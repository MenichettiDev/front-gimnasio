<div class="container-base card-base" style="max-width:480px; margin:auto;">
    <form [formGroup]="configForm" class="card-body-base" (ngSubmit)="iniciar()">
        <h2 class="form-title-base">Cron√≥metro</h2>

        <!-- Cuadr√≠cula de modos en lugar de select -->
        <div class="mode-grid" role="tablist">
            <button type="button" class="mode-card" [ngClass]="{'mode-selected': configForm.value.mode === 'simple'}"
                (click)="selectMode('simple')">
                <div class="mode-title">Cron√≥metro simple</div>
                <div class="mode-sub">‚è±Ô∏è Mide tiempo hacia arriba</div>
            </button>
            <button type="button" class="mode-card" [ngClass]="{'mode-selected': configForm.value.mode === 'intervals'}"
                (click)="selectMode('intervals')">
                <div class="mode-title">Intervalos (HIIT)</div>
                <div class="mode-sub">üîÑ Trabajo/Descanso repetido</div>
            </button>
            <button type="button" class="mode-card" [ngClass]="{'mode-selected': configForm.value.mode === 'emom'}"
                (click)="selectMode('emom')">
                <div class="mode-title">EMOM</div>
                <div class="mode-sub">‚è∞ Inicio cada minuto</div>
            </button>
            <button type="button" class="mode-card" [ngClass]="{'mode-selected': configForm.value.mode === 'countdown'}"
                (click)="selectMode('countdown')">
                <div class="mode-title">Cuenta regresiva</div>
                <div class="mode-sub">‚¨áÔ∏è Tiempo fijo</div>
            </button>
        </div>

        <!-- Campos por modo (igual que antes) -->
        <!-- Simple (stopwatch) -->
        <div *ngIf="configForm.value.mode === 'simple'" class="form-group">
            <label class="form-label-base" for="simpleDuration">Duraci√≥n sugerida (segundos)</label>
            <input type="number" id="simpleDuration" formControlName="simpleDuration" class="form-control-base"
                min="1" />
        </div>

        <!-- Intervals -->
        <div *ngIf="configForm.value.mode === 'intervals'">
            <div class="form-group">
                <label class="form-label-base" for="series">Cantidad de series</label>
                <input type="number" id="series" formControlName="series" class="form-control-base" min="1" />
            </div>
            <div class="form-group">
                <label class="form-label-base" for="tiempoSerie">Tiempo por serie (segundos)</label>
                <input type="number" id="tiempoSerie" formControlName="tiempoSerie" class="form-control-base" min="1" />
            </div>
            <div class="form-group">
                <label class="form-label-base" for="descanso">Descanso entre series (segundos)</label>
                <input type="number" id="descanso" formControlName="descanso" class="form-control-base" min="0" />
            </div>
        </div>

        <!-- EMOM -->
        <div *ngIf="configForm.value.mode === 'emom'" class="form-group">
            <label class="form-label-base" for="emomRounds">Minutos / Rondas</label>
            <input type="number" id="emomRounds" formControlName="emomRounds" class="form-control-base" min="1" />
            <div class="form-text-base">Cada ronda dura 60s; se avisa al inicio de cada minuto.</div>
        </div>

        <!-- Countdown -->
        <div *ngIf="configForm.value.mode === 'countdown'" class="form-group">
            <label class="form-label-base" for="countdownDuration">Duraci√≥n total (segundos)</label>
            <input type="number" id="countdownDuration" formControlName="countdownDuration" class="form-control-base"
                min="1" />
        </div>

        <!-- reemplazo del inline style por clase para controlar layout de botones -->
        <div class="form-actions">
            <button type="submit" class="btn-base btn-primary-base action-btn" [disabled]="corriendo">Iniciar</button>
            <button type="button" class="btn-base btn-secondary-base action-btn" (click)="reiniciar()"
                [disabled]="!corriendo && !terminado">Reiniciar</button>
        </div>
    </form>

    <!-- Mostrar siempre el visual del tiempo mientras haya un modo seleccionado -->
    <div *ngIf="configForm.value.mode" class="cronometro-visual">
        <div [ngClass]="{
                'cronometro-circle-serie': configForm.value.mode === 'intervals' && !modoDescanso,
                'cronometro-circle-descanso': configForm.value.mode === 'intervals' && modoDescanso,
                'cronometro-circle': configForm.value.mode !== 'intervals'
            }">
            <span class="cronometro-tiempo">{{ tiempoMinSec }}</span>
        </div>

        <div class="cronometro-info">
            <!-- simple -->
            <span *ngIf="configForm.value.mode === 'simple' && !terminado">Tiempo transcurrido: {{ tiempoMinSec
                }}</span>
            <span *ngIf="configForm.value.mode === 'simple' && terminado" style="color:#4CAF50;">¬°Finalizado!</span>

            <!-- intervals -->
            <span *ngIf="configForm.value.mode === 'intervals' && !modoDescanso && !terminado" class="white">Serie {{
                serieActual }} /
                {{ configForm.value.series }}</span>
            <span *ngIf="configForm.value.mode === 'intervals' && modoDescanso && !terminado"
                class="white">Descanso</span>
            <span *ngIf="configForm.value.mode === 'intervals' && terminado" class="white">¬°Finalizado!</span>

            <!-- emom -->
            <span *ngIf="configForm.value.mode === 'emom' && !terminado">Ronda {{ emomRonda }} / {{
                configForm.value.emomRounds }}</span>
            <span *ngIf="configForm.value.mode === 'emom' && terminado" style="color:#4CAF50;">¬°Finalizado!</span>

            <!-- countdown -->
            <span *ngIf="configForm.value.mode === 'countdown' && !terminado">Cuenta regresiva</span>
            <span *ngIf="configForm.value.mode === 'countdown' && terminado" style="color:#4CAF50;">¬°Finalizado!</span>
        </div>

        <div class="cronometro-controls">
            <button *ngIf="corriendo" class="btn-base btn-secondary-base" (click)="pausar()">Pausar</button>
            <button
                *ngIf="!corriendo && !terminado && (configForm.value.mode === 'simple' ? tiempoTranscurrido>0 : tiempoRestante > 0)"
                class="btn-base btn-primary-base reanudar-btn" (click)="reanudar()">Reanudar</button>
        </div>
    </div>
</div>